{"version":3,"sources":["views/Chat/components/ConversationList/components/ConversationListItem/ConversationListItem.js","views/Chat/components/ConversationList/ConversationList.js","views/Chat/components/ConversationDetails/components/ConversationToolbar/ConversationToolbar.js","views/Chat/components/ConversationDetails/components/ConversationMessage/ConversationMessage.js","views/Chat/components/ConversationDetails/components/ConversationMessages/ConversationMessages.js","views/Chat/components/ConversationDetails/components/ConversationForm/ConversationForm.js","store/actions/messageActions.js","views/Chat/components/ConversationDetails/ConversationDetails.js","views/Chat/components/ConversationPlaceholder/ConversationPlaceholder.js","views/Chat/Chat.js","store/actions/conversationActions.js"],"names":["useStyles","makeStyles","theme","active","boxShadow","palette","primary","main","backgroundColor","colors","grey","avatar","height","width","details","marginLeft","spacing","display","flexDirection","alignItems","unread","marginTop","padding","minWidth","ConversationListItem","props","conversation","className","rest","classes","authId","useSelector","state","auth","_id","selectedConversation","firstUser","uid","secondUser","ListItem","button","clsx","component","RouterLink","to","conversationId","ListItemAvatar","Avatar","alt","src","profilePicture","ListItemText","name","primaryTypographyProps","noWrap","variant","secondary","secondaryTypographyProps","Typography","root","white","searchInput","flexGrow","ConversationList","conversations","useRouter","match","params","id","Toolbar","Input","disableUnderline","placeholder","Tooltip","title","IconButton","edge","Divider","List","disablePadding","map","i","divider","length","backButton","marginRight","user","flexShrink","activity","statusBullet","search","flexBasis","breakpoints","down","flex","searchIcon","color","icon","ConversationToolbar","moreRef","useRef","useState","openMenu","setOpenMenu","Hidden","mdDown","Paper","elevation","onClick","ref","Menu","anchorEl","current","keepMounted","onClose","open","MenuItem","ListItemIcon","marginBottom","authUser","justifyContent","background","blueGrey","inner","maxWidth","body","text","borderRadius","shape","content","image","footer","ConversationMessage","message","sender","Link","contentType","moment","date","fromNow","overflow","maxHeight","ConversationMessages","messages","messagesEndRef","useEffect","scrollIntoView","behavior","scrollToBottom","paper","input","fileInput","form","ConversationForm","setMessage","dispatch","useDispatch","noValidate","onSubmit","e","preventDefault","persist","newMessage","Date","getState","axios","post","url","setHeaders","then","type","catch","error","console","log","response","toast","data","position","POSITION","BOTTOM_RIGHT","addMessage","value","onChange","target","ConversationDetails","textAlign","margin","ConversationPlaceholder","transform","openConversion","conversationList","borderRight","conversationDetails","conversationPlaceholder","Chat","history","router","getUsersConversations","conversationsList","get","messagesList","selectedConversationMessages","appState","push","find","c","filter","m","Page","currentUserId","addConversation","newConversation"],"mappings":"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","file":"static/js/10.ebedea32.chunk.js","sourcesContent":["import React from 'react';\r\nimport {Link as RouterLink} from 'react-router-dom';\r\nimport clsx from 'clsx';\r\nimport moment from 'moment';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {\r\n    Typography,\r\n    ListItem,\r\n    ListItemAvatar,\r\n    ListItemText,\r\n    Avatar,\r\n    colors\r\n} from '@material-ui/core';\r\n\r\nimport Label from \"../../../../../../components/Label\";\r\nimport {useSelector} from \"react-redux\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    active: {\r\n        boxShadow: `inset 4px 0px 0px ${theme.palette.primary.main}`,\r\n        backgroundColor: colors.grey[50]\r\n    },\r\n    avatar: {\r\n        height: 40,\r\n        width: 40\r\n    },\r\n    details: {\r\n        marginLeft: theme.spacing(2),\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'flex-end'\r\n    },\r\n    unread: {\r\n        marginTop: 2,\r\n        padding: 2,\r\n        height: 18,\r\n        minWidth: 18\r\n    }\r\n}));\r\n\r\nconst ConversationListItem = props => {\r\n    const {active, conversation, className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n    //const lastMessage = conversation.messages[conversation.messages.length - 1];\r\n\r\n    const authId = useSelector(state => state.auth._id);\r\n\r\n    let selectedConversation = {};\r\n    if(conversation.firstUser.uid === authId) {\r\n        selectedConversation = {...conversation.secondUser}\r\n    } else {\r\n        selectedConversation = {...conversation.firstUser}\r\n    }\r\n\r\n    return (\r\n        <ListItem\r\n            {...rest}\r\n            button\r\n            className={clsx(\r\n                {\r\n                    [classes.active]: active\r\n                },\r\n                className\r\n            )}\r\n            component={RouterLink}\r\n            to={`/chat/${conversation.conversationId}`}\r\n        >\r\n            <ListItemAvatar>\r\n                <Avatar\r\n                    alt=\"Ава\"\r\n                    className={classes.avatar}\r\n                    src={selectedConversation.profilePicture}\r\n                />\r\n            </ListItemAvatar>\r\n            <ListItemText\r\n                primary={selectedConversation.name}\r\n                primaryTypographyProps={{\r\n                    noWrap: true,\r\n                    variant: 'h6'\r\n                }}\r\n                //secondary={`${lastMessage.sender.name}: ${lastMessage.content}`}\r\n                secondary={`ID диалога: ${conversation.conversationId}`}\r\n                secondaryTypographyProps={{\r\n                    noWrap: true,\r\n                    variant: 'body1'\r\n                }}\r\n            />\r\n            <div className={classes.details}>\r\n                <Typography\r\n                    noWrap\r\n                    variant=\"body2\"\r\n                >\r\n                    {/*{moment(lastMessage.created_at).isSame(moment(), 'day')*/}\r\n                    {/*    ? moment(lastMessage.created_at).format('LT')*/}\r\n                    {/*    : moment(lastMessage.created_at).fromNow()}*/}\r\n                </Typography>\r\n                {/*{conversation.unread > 0 && (*/}\r\n                {/*    <Label*/}\r\n                {/*        className={classes.unread}*/}\r\n                {/*        color={colors.red[500]}*/}\r\n                {/*        shape=\"rounded\"*/}\r\n                {/*    >*/}\r\n                {/*        {conversation.unread}*/}\r\n                {/*    </Label>*/}\r\n                {/*)}*/}\r\n            </div>\r\n        </ListItem>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationListItem;\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {\r\n    Toolbar,\r\n    Input,\r\n    IconButton,\r\n    Tooltip,\r\n    Divider,\r\n    List\r\n} from '@material-ui/core';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\n\r\nimport useRouter from \"../../../../utils/useRouter\";\r\nimport {ConversationListItem} from './components';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        backgroundColor: theme.palette.white\r\n    },\r\n    searchInput: {\r\n        flexGrow: 1\r\n    }\r\n}));\r\n\r\nconst ConversationList = props => {\r\n    const {conversations, className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n    const router = useRouter();\r\n    const selectedConversation = router.match.params.id;\r\n\r\n    return (\r\n        <div\r\n            {...rest}\r\n            className={clsx(classes.root, className)}\r\n        >\r\n            <Toolbar>\r\n                <Input\r\n                    className={classes.searchInput}\r\n                    disableUnderline\r\n                    placeholder=\"Найти диалог\"\r\n                />\r\n                <Tooltip title=\"Поиск\">\r\n                    <IconButton edge=\"end\">\r\n                        <SearchIcon/>\r\n                    </IconButton>\r\n                </Tooltip>\r\n            </Toolbar>\r\n            <Divider/>\r\n            <List disablePadding>\r\n                {conversations.map((conversation, i) => (\r\n                    <ConversationListItem\r\n                        active={conversation.id === selectedConversation}\r\n                        conversation={conversation}\r\n                        divider={i < conversations.length - 1}\r\n                        key={conversation.id}\r\n                    />\r\n                ))}\r\n            </List>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationList;\r\n","import React, {useRef, useState} from 'react';\r\nimport {Link as RouterLink} from 'react-router-dom';\r\nimport clsx from 'clsx';\r\nimport moment from 'moment';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {\r\n    Hidden,\r\n    IconButton,\r\n    Input,\r\n    ListItemIcon,\r\n    ListItemText,\r\n    Menu,\r\n    MenuItem,\r\n    Paper,\r\n    Toolbar,\r\n    Tooltip,\r\n    Typography\r\n} from '@material-ui/core';\r\nimport KeyboardBackspaceIcon from '@material-ui/icons/KeyboardBackspace';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport BlockIcon from '@material-ui/icons/Block';\r\nimport DeleteIcon from '@material-ui/icons/DeleteOutlined';\r\nimport ArchiveIcon from '@material-ui/icons/ArchiveOutlined';\r\nimport NotificationsOffIcon from '@material-ui/icons/NotificationsOffOutlined';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport StatusBullet from \"../../../../../../components/StatusBullet\";\r\nimport {useSelector} from \"react-redux\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        backgroundColor: theme.palette.white\r\n    },\r\n    backButton: {\r\n        marginRight: theme.spacing(2),\r\n        '@media (min-width: 864px)': {\r\n            display: 'none'\r\n        }\r\n    },\r\n    user: {\r\n        flexShrink: 0,\r\n        flexGrow: 1\r\n    },\r\n    activity: {\r\n        display: 'flex',\r\n        alignItems: 'center'\r\n    },\r\n    statusBullet: {\r\n        marginRight: theme.spacing(1)\r\n    },\r\n    search: {\r\n        height: 42,\r\n        padding: theme.spacing(0, 2),\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        flexBasis: 300,\r\n        marginLeft: 'auto',\r\n        [theme.breakpoints.down('sm')]: {\r\n            flex: '1 1 auto'\r\n        }\r\n    },\r\n    searchIcon: {\r\n        marginRight: theme.spacing(2),\r\n        color: theme.palette.icon\r\n    },\r\n    searchInput: {\r\n        flexGrow: 1\r\n    }\r\n}));\r\n\r\nconst ConversationToolbar = props => {\r\n    const {conversation, className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n    const moreRef = useRef(null);\r\n    const [openMenu, setOpenMenu] = useState(false);\r\n\r\n    const handleMenuOpen = () => {\r\n        setOpenMenu(true);\r\n    };\r\n\r\n    const handleMenuClose = () => {\r\n        setOpenMenu(false);\r\n    };\r\n\r\n    const authId = useSelector(state => state.auth._id);\r\n\r\n    let selectedConversation = {};\r\n    if(conversation.firstUser.uid === authId) {\r\n        selectedConversation = {...conversation.secondUser}\r\n    } else {\r\n        selectedConversation = {...conversation.firstUser}\r\n    }\r\n\r\n    return (\r\n        <Toolbar\r\n            {...rest}\r\n            className={clsx(classes.root, className)}\r\n        >\r\n            <Tooltip title=\"Назад\">\r\n                <IconButton\r\n                    className={classes.backButton}\r\n                    component={RouterLink}\r\n                    edge=\"start\"\r\n                    to=\"/chat\"\r\n                >\r\n                    <KeyboardBackspaceIcon/>\r\n                </IconButton>\r\n            </Tooltip>\r\n            <div className={classes.user}>\r\n                <Typography variant=\"h6\">{selectedConversation.name}</Typography>\r\n                <Typography variant=\"body2\">ID диалога: {conversation.conversationId}</Typography>\r\n                {/*<div className={classes.activity}>*/}\r\n                {/*    {conversation.otherUser.active ? (*/}\r\n                {/*        <>*/}\r\n                {/*            <StatusBullet*/}\r\n                {/*                className={classes.statusBullet}*/}\r\n                {/*                color=\"success\"*/}\r\n                {/*                size=\"small\"*/}\r\n                {/*            />*/}\r\n                {/*            <Typography variant=\"body2\">Сейчас онлайн</Typography>*/}\r\n                {/*        </>*/}\r\n                {/*    ) : (*/}\r\n                {/*        <Typography variant=\"body2\">*/}\r\n                {/*            Active {moment(conversation.otherUser.lastActivity).fromNow()}*/}\r\n                {/*        </Typography>*/}\r\n                {/*    )}*/}\r\n                {/*</div>*/}\r\n            </div>\r\n            <Hidden mdDown>\r\n            <Paper\r\n                className={classes.search}\r\n                elevation={1}\r\n            >\r\n                <SearchIcon className={classes.searchIcon}/>\r\n                <Input\r\n                    className={classes.searchInput}\r\n                    disableUnderline\r\n                    placeholder=\"Поиск по диалогу\"\r\n                />\r\n            </Paper>\r\n            <Tooltip title=\"Больше\">\r\n                <IconButton\r\n                    onClick={handleMenuOpen}\r\n                    ref={moreRef}\r\n                >\r\n                    <MoreIcon/>\r\n                </IconButton>\r\n            </Tooltip>\r\n            <Menu\r\n                anchorEl={moreRef.current}\r\n                keepMounted\r\n                onClose={handleMenuClose}\r\n                open={openMenu}\r\n            >\r\n                <MenuItem>\r\n                    <ListItemIcon>\r\n                        <BlockIcon/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"Заблокировать пользователя\"/>\r\n                </MenuItem>\r\n                <MenuItem>\r\n                    <ListItemIcon>\r\n                        <DeleteIcon/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"Удалить сообщения\"/>\r\n                </MenuItem>\r\n                <MenuItem>\r\n                    <ListItemIcon>\r\n                        <NotificationsOffIcon/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"Отключить уведомления\"/>\r\n                </MenuItem>\r\n            </Menu>\r\n            </Hidden>\r\n        </Toolbar>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationToolbar;\r\n","import React from 'react';\r\nimport {Link as RouterLink} from 'react-router-dom';\r\nimport clsx from 'clsx';\r\nimport moment from 'moment';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {Typography, Link, Avatar, colors} from '@material-ui/core';\r\nimport {useSelector} from \"react-redux\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        marginBottom: theme.spacing(2)\r\n    },\r\n    authUser: {\r\n        display: 'flex',\r\n        justifyContent: 'flex-end',\r\n        '& $body': {\r\n            background: colors.blueGrey[100]\r\n        }\r\n    },\r\n    inner: {\r\n        display: 'flex',\r\n        maxWidth: 500\r\n    },\r\n    avatar: {\r\n        marginRight: theme.spacing(2)\r\n    },\r\n    body: {\r\n        backgroundColor: colors.grey[200],\r\n        color: theme.palette.text.primary,\r\n        borderRadius: theme.shape.borderRadius,\r\n        padding: theme.spacing(1, 1.5)\r\n    },\r\n    content: {\r\n        marginTop: theme.spacing(0.3)\r\n    },\r\n    image: {\r\n        marginTop: theme.spacing(2),\r\n        height: 'auto',\r\n        width: 380,\r\n        maxWidth: '100%'\r\n    },\r\n    footer: {\r\n        marginTop: theme.spacing(1),\r\n        display: 'flex',\r\n        justifyContent: 'flex-end'\r\n    }\r\n}));\r\n\r\nconst ConversationMessage = props => {\r\n    const {message, className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n\r\n    const authId = useSelector(state => state.auth._id);\r\n\r\n    const authUser = (uid, authId) => {\r\n        return uid === authId;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            {...rest}\r\n            className={clsx(\r\n                classes.root,\r\n                {\r\n                    [classes.authUser]: authUser(message.sender.uid, authId)\r\n                },\r\n                className\r\n            )}\r\n        >\r\n            <div className={classes.inner}>\r\n                <Avatar\r\n                    className={classes.avatar}\r\n                    component={RouterLink}\r\n                    src={message.sender.profilePicture}\r\n                    to={`/profile/${message.sender.uid}/wall`}\r\n                />\r\n                <div>\r\n                    <div className={classes.body}>\r\n                        <Typography variant=\"body2\" color=\"secondary\">\r\n                            <Link\r\n                                color=\"inherit\"\r\n                                component={RouterLink}\r\n                                to={`/profile/${message.sender.uid}/wall`}\r\n                                variant=\"h6\"\r\n                            >\r\n                                {authUser(message.sender.uid, authId) ? message.sender.name : message.sender.name}\r\n                            </Link>\r\n                        </Typography>\r\n                        <div className={classes.content}>\r\n                            {message.contentType === 'image' ? (\r\n                                <img\r\n                                    alt=\"Картинка\"\r\n                                    className={classes.image}\r\n                                    src={message.content}\r\n                                />\r\n                            ) : (\r\n                                <Typography\r\n                                    color=\"inherit\"\r\n                                    variant=\"subtitle1\"\r\n                                >\r\n                                    {message.content}\r\n                                </Typography>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                    <div className={classes.footer}>\r\n                        <Typography\r\n                            variant=\"body2\"\r\n                        >\r\n                            {moment(message.date).fromNow()}\r\n                        </Typography>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationMessage;\r\n","import React, {useEffect, useRef, useState} from 'react';\r\nimport clsx from 'clsx';\r\nimport PerfectScrollbar from 'react-perfect-scrollbar';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\n\r\nimport ConversationMessage from '../ConversationMessage';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        flexGrow: 1,\r\n        overflow: \"hidden\",\r\n        maxHeight: '100%'\r\n    },\r\n    inner: {\r\n        overflow: \"auto\",\r\n        padding: theme.spacing(7),\r\n    }\r\n}));\r\n\r\nconst ConversationMessages = props => {\r\n    const {messages, className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n\r\n    const messagesEndRef = useRef(null);\r\n\r\n    const scrollToBottom = () => {\r\n        messagesEndRef.current?.scrollIntoView({behavior: \"smooth\"})\r\n    };\r\n\r\n    useEffect(() => {\r\n        scrollToBottom()\r\n    }, [messages]);\r\n\r\n    // не работает прокрутка вниз с перфект баром, надо внедрить что-то подобное:\r\n    // const lastIndex = row.length - 1;\r\n    // row.map((rank, i) => {\r\n    //   if (i === lastIndex) {\r\n    //     // последнее сообщение\r\n    //   } else {\r\n    //     // не последнее сообщение\r\n    //   }\r\n    // })\r\n\r\n    return (\r\n        <div\r\n            {...rest}\r\n            className={clsx(classes.root, className)}\r\n        >\r\n            <PerfectScrollbar>\r\n                <div className={classes.inner}>\r\n                    {messages.map(message => {\r\n                        return (\r\n                            <ConversationMessage\r\n                                key={message.id}\r\n                                message={message}\r\n                            />\r\n                        );\r\n                    })}\r\n                    <div ref={messagesEndRef}/>\r\n                </div>\r\n            </PerfectScrollbar>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationMessages;\r\n","import React, {useRef, useState} from 'react';\r\nimport clsx from 'clsx';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {\r\n    Avatar,\r\n    Divider,\r\n    IconButton,\r\n    Input,\r\n    Paper,\r\n    Tooltip\r\n} from '@material-ui/core';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport AddPhotoIcon from '@material-ui/icons/AddPhotoAlternate';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {addMessage} from \"../../../../../../store/actions/messageActions\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        backgroundColor: theme.palette.white,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        padding: theme.spacing(1, 2)\r\n    },\r\n    paper: {\r\n        flexGrow: 1,\r\n        marginLeft: theme.spacing(2),\r\n        padding: theme.spacing(0.5, 2)\r\n    },\r\n    input: {\r\n        width: '100%'\r\n    },\r\n    divider: {\r\n        width: 1,\r\n        height: 24\r\n    },\r\n    fileInput: {\r\n        display: 'none'\r\n    },\r\n    form: {\r\n        width: '100%'\r\n    }\r\n}));\r\n\r\nconst ConversationForm = props => {\r\n    let {className, authUser, conversation, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n\r\n    // const fileInputRef = useRef(null);\r\n    //\r\n    // let cId;\r\n    // if (!conversationId) {\r\n    //     cId = uuidv4()\r\n    // } else {\r\n    //     cId = conversation.cId;\r\n    // }\r\n\r\n    debugger\r\n\r\n    const [message, setMessage] = useState({\r\n        conversationId: conversation.conversationId,\r\n        content: '',\r\n    });\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        e.persist();\r\n\r\n        const newMessage = {\r\n            ...message,\r\n            date: new Date()\r\n        }\r\n\r\n        dispatch(addMessage(newMessage));\r\n        setMessage({content: ''});\r\n    }\r\n\r\n    // const handleChange = event => {\r\n    //     event.persist();\r\n    //\r\n    //     setMessage(event.target.message);\r\n    // };\r\n\r\n    // const handleAttach = () => {\r\n    //     fileInputRef.current.click();\r\n    // };\r\n\r\n    return (\r\n        <form className={classes.form} noValidate onSubmit={handleSubmit}>\r\n            <div\r\n                {...rest}\r\n                className={clsx(classes.root, className)}\r\n            >\r\n                <Avatar\r\n                    alt=\"Person\"\r\n                    src={authUser.profilePicture}\r\n                />\r\n                <Paper\r\n                    className={classes.paper}\r\n                    elevation={1}\r\n                >\r\n                    <Input\r\n                        className={classes.input}\r\n                        disableUnderline\r\n                        // onChange={handleChange}\r\n                        placeholder=\"Напишите что-нибудь...\"\r\n                        value={message.content}\r\n                        onChange={(e) => setMessage({\r\n                            ...message, content: e.target.value,\r\n                        })}\r\n                    />\r\n                </Paper>\r\n                <Tooltip\r\n                    title=\"Отправить\"\r\n                    type=\"submit\"\r\n                >\r\n                    <IconButton color='primary'>\r\n                        <SendIcon/>\r\n                    </IconButton>\r\n                </Tooltip>\r\n                <Divider className={classes.divider}/>\r\n                {/*<Tooltip title=\"Сохранить фото\">*/}\r\n                {/*    <IconButton*/}\r\n                {/*        edge=\"end\"*/}\r\n                {/*        onClick={handleAttach}*/}\r\n                {/*    >*/}\r\n                {/*        <AddPhotoIcon/>*/}\r\n                {/*    </IconButton>*/}\r\n                {/*</Tooltip>*/}\r\n                {/*<Tooltip title=\"Загрузить файл\">*/}\r\n                {/*    <IconButton*/}\r\n                {/*        edge=\"end\"*/}\r\n                {/*        onClick={handleAttach}*/}\r\n                {/*    >*/}\r\n                {/*        <AttachFileIcon/>*/}\r\n                {/*    </IconButton>*/}\r\n                {/*</Tooltip>*/}\r\n                {/*<input*/}\r\n                {/*    className={classes.fileInput}*/}\r\n                {/*    ref={fileInputRef}*/}\r\n                {/*    type=\"file\"*/}\r\n                {/*/>*/}\r\n            </div>\r\n        </form>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationForm;\r\n","import axios from \"axios\";\r\nimport {url, setHeaders} from \"../../api\";\r\nimport {toast} from \"react-toastify\";\r\n\r\nexport const getConversationMessages = (conversationId) => {\r\n    return (dispatch) => {\r\n        axios\r\n            .get(`${url}/messages/${conversationId}`, setHeaders())\r\n            .then((messagesList) => {\r\n                dispatch({\r\n                    type: \"CLEAR_MESSAGES\"\r\n                })\r\n                dispatch({\r\n                    type: \"GET_MESSAGES\",\r\n                    messagesList,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n            });\r\n    };\r\n};\r\n\r\nexport const addMessage = (newMessage) => {\r\n    return (dispatch, getState) => {\r\n        const uid = getState().auth._id;\r\n        const name = getState().auth.name;\r\n        const profilePicture = getState().auth.profilePicture;\r\n        axios\r\n            .post(`${url}/messages`, {...newMessage, sender:{uid,name,profilePicture}}, setHeaders())\r\n            .then((message) => {\r\n                dispatch({\r\n                    type: \"ADD_MESSAGE\",\r\n                    message,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error.response);\r\n\r\n                toast.error(error.response?.data, {\r\n                    position: toast.POSITION.BOTTOM_RIGHT,\r\n                });\r\n            });\r\n    };\r\n};\r\n\r\nexport const deleteMessage = (_id) => {\r\n    return (dispatch) => {\r\n        axios\r\n            .delete(`${url}/messages/${_id}`, setHeaders())\r\n            .then(() => {\r\n                dispatch({\r\n                    type: \"DELETE_MESSAGE\",\r\n                    _id,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n                toast.error(error.response?.data, {\r\n                    position: toast.POSITION.BOTTOM_RIGHT,\r\n                });\r\n            });\r\n    };\r\n};\r\n\r\n// export const getProjectById = (projectId) => {\r\n//     return (dispatch) => {\r\n//         axios\r\n//             .get(`${url}/projects/current/${projectId}`, setProjectHeaders())\r\n//             .then((projectById) => {\r\n//                 dispatch({\r\n//                     type: \"GET_PROJECT_BY_ID\",\r\n//                     projectById,\r\n//                 });\r\n//             })\r\n//             .catch((error) => {\r\n//                 console.log(error);\r\n//             });\r\n//     };\r\n// };","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {Divider} from '@material-ui/core';\r\n\r\nimport {\r\n    ConversationToolbar,\r\n    ConversationMessages,\r\n    ConversationForm\r\n} from './components';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        backgroundColor: theme.palette.white\r\n    }\r\n}));\r\n\r\nconst ConversationDetails = props => {\r\n    const {conversation, authUser, messages, className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <div\r\n            {...rest}\r\n            className={clsx(classes.root, className)}\r\n        >\r\n            <ConversationToolbar conversation={conversation}/>\r\n            <Divider/>\r\n            <ConversationMessages messages={messages}/>\r\n            <Divider/>\r\n            <ConversationForm conversation={conversation} authUser={authUser}/>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationDetails;\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {Typography} from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center'\r\n    },\r\n    inner: {\r\n        textAlign: 'center'\r\n    },\r\n    image: {\r\n        maxWidth: 400\r\n    },\r\n    title: {\r\n        margin: theme.spacing(4, 0, 1, 0)\r\n    }\r\n}));\r\n\r\nconst ConversationPlaceholder = props => {\r\n    const {className, ...rest} = props;\r\n\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <div\r\n            {...rest}\r\n            className={clsx(classes.root, className)}\r\n        >\r\n            <div className={classes.inner}>\r\n                <Typography variant=\"subtitle1\">\r\n                    Выберете диалог слева, чтобы начать переписку\r\n                </Typography>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ConversationPlaceholder;\r\n","import React, {useEffect} from 'react';\r\nimport clsx from 'clsx';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport useRouter from \"../../utils/useRouter\"\r\nimport Page from \"../../components/Page\";\r\nimport {\r\n    ConversationList,\r\n    ConversationDetails,\r\n    ConversationPlaceholder\r\n} from './components';\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {getUsersConversations} from \"../../store/actions/conversationActions\";\r\nimport {getConversationMessages} from \"../../store/actions/messageActions\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        height: '100%',\r\n        display: 'flex',\r\n        '@media (max-width: 863px)': {\r\n            '& $conversationList, & $conversationDetails': {\r\n                flexBasis: '100%',\r\n                width: '100%',\r\n                maxWidth: 'none',\r\n                flexShrink: '0',\r\n                transform: 'translateX(0)'\r\n            }\r\n        }\r\n    },\r\n    openConversion: {\r\n        '@media (max-width: 863px)': {\r\n            '& $conversationList, & $conversationDetails': {\r\n                transform: 'translateX(-100%)'\r\n            }\r\n        }\r\n    },\r\n    conversationList: {\r\n        width: 300,\r\n        flexBasis: 300,\r\n        flexShrink: 0,\r\n        '@media (min-width: 864px)': {\r\n            borderRight: `1px solid ${theme.palette.divider}`\r\n        }\r\n    },\r\n    conversationDetails: {\r\n        flexGrow: 1\r\n    },\r\n    conversationPlaceholder: {\r\n        flexGrow: 1\r\n    }\r\n}));\r\n\r\nconst Chat = props => {\r\n    const {history} = props;\r\n    const classes = useStyles();\r\n    const router = useRouter();\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const authUser = useSelector(state => state.auth)\r\n\r\n    useEffect(() => {\r\n        dispatch(getUsersConversations(authUser._id))\r\n    }, [dispatch])\r\n\r\n    const conversations = useSelector(state => state.conversationsList)\r\n\r\n    useEffect(() => {\r\n        dispatch(getConversationMessages(router.match.params.id))\r\n    }, [dispatch, router.match.params.id])\r\n\r\n    const messages = useSelector(state => state.messagesList)\r\n\r\n    // conversations.forEach(function (conversation) {\r\n    //     conversation.messages = \"false\";\r\n    // });\r\n\r\n    const appState = useSelector((state) => state);\r\n    console.log(appState);\r\n\r\n    const auth = useSelector(state => state.auth)\r\n    if (!auth._id) (\r\n        history.push('/')\r\n    )\r\n\r\n    // const [conversations, setConversations] = useState([]);\r\n\r\n    let selectedConversation;\r\n    let selectedConversationMessages;\r\n\r\n    if (router.match.params.id) {\r\n        selectedConversation = conversations.find(\r\n            c => c.conversationId === router.match.params.id\r\n        );\r\n        selectedConversationMessages = messages.filter(\r\n            m => m.conversationId === router.match.params.id\r\n        )\r\n    }\r\n\r\n    return (\r\n        <Page\r\n            className={clsx({\r\n                [classes.root]: true,\r\n                [classes.openConversion]: selectedConversation\r\n            })}\r\n            title=\"Чаты\"\r\n        >\r\n            <ConversationList\r\n                className={classes.conversationList}\r\n                conversations={conversations}\r\n            />\r\n            {(selectedConversation && selectedConversationMessages) ? (\r\n                <ConversationDetails\r\n                    className={classes.conversationDetails}\r\n                    conversation={selectedConversation}\r\n                    messages={selectedConversationMessages}\r\n                    authUser={authUser}\r\n                />\r\n            ) : (\r\n                <ConversationPlaceholder className={classes.conversationPlaceholder}/>\r\n            )}\r\n        </Page>\r\n    );\r\n};\r\n\r\nexport default Chat;\r\n","import axios from \"axios\";\r\nimport {url, setHeaders} from \"../../api\";\r\nimport {toast} from \"react-toastify\";\r\n\r\nexport const getUsersConversations = (currentUserId) => {\r\n    return (dispatch) => {\r\n        axios\r\n            .get(`${url}/conversations/${currentUserId}`, setHeaders())\r\n            .then((conversationsList) => {\r\n                dispatch({\r\n                    type: \"CLEAR_CONVERSATIONS\"\r\n                })\r\n                dispatch({\r\n                    type: \"GET_CONVERSATIONS\",\r\n                    conversationsList,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n            });\r\n    };\r\n};\r\n\r\nexport const addConversation = (newConversation) => {\r\n    return (dispatch) => {\r\n        axios\r\n            .post(`${url}/conversations`, { ...newConversation }, setHeaders())\r\n            .then((conversation) => {\r\n                // dispatch({\r\n                //     type: \"CLEAR_CONVERSATIONS\",\r\n                // });\r\n                dispatch({\r\n                    type: \"ADD_CONVERSATION\",\r\n                    conversation,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error.response);\r\n\r\n                toast.error(error.response?.data, {\r\n                    position: toast.POSITION.BOTTOM_RIGHT,\r\n                });\r\n            });\r\n    };\r\n};\r\n\r\nexport const deleteConversation = (conversationId) => {\r\n    return (dispatch) => {\r\n        axios\r\n            .delete(`${url}/conversations/${conversationId}`, setHeaders())\r\n            .then(() => {\r\n                dispatch({\r\n                    type: \"DELETE_PROJECT\",\r\n                    conversationId,\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n                toast.error(error.response?.data, {\r\n                    position: toast.POSITION.BOTTOM_RIGHT,\r\n                });\r\n            });\r\n    };\r\n};\r\n\r\n// export const getProjectById = (projectId) => {\r\n//     return (dispatch) => {\r\n//         axios\r\n//             .get(`${url}/projects/current/${projectId}`, setProjectHeaders())\r\n//             .then((projectById) => {\r\n//                 dispatch({\r\n//                     type: \"GET_PROJECT_BY_ID\",\r\n//                     projectById,\r\n//                 });\r\n//             })\r\n//             .catch((error) => {\r\n//                 console.log(error);\r\n//             });\r\n//     };\r\n// };"],"sourceRoot":""}