(this.webpackJsonpfat=this.webpackJsonpfat||[]).push([[10],{1709:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Te}));var n=a(19),c=a(0),s=a(3),i=a(567),r=(a(68),a(73)),o=a(186),l=a(6),j=a(12),d=a(433),b=a(584),u=a(446),O=a(365),h=a(422),m=a(425),f=a(553),p=a.n(f),x=a(25),v=a(9),g=a.n(v),N=a(4),y=a(426),I=a(427),w=a(549),S=a(428),T=a(56),C=(a(61),a(28)),k=a(1),U=["active","conversation","className"],E=Object(i.a)((function(e){return{active:{boxShadow:"inset 4px 0px 0px ".concat(e.palette.primary.main),backgroundColor:N.a.grey[50]},avatar:{height:40,width:40},details:{marginLeft:e.spacing(2),display:"flex",flexDirection:"column",alignItems:"flex-end"},unread:{marginTop:2,padding:2,height:18,minWidth:18}}})),G=function(e){var t=e.active,a=e.conversation,c=e.className,i=Object(j.a)(e,U),r=E(),o=Object(C.c)((function(e){return e.auth._id})),d={};return d=a.firstUser.uid===o?Object(l.a)({},a.secondUser):Object(l.a)({},a.firstUser),Object(k.jsxs)(y.a,Object(l.a)(Object(l.a)({},i),{},{button:!0,className:Object(s.default)(Object(n.a)({},r.active,t),c),component:x.b,to:"/chat/".concat(a.conversationId),children:[Object(k.jsx)(I.a,{children:Object(k.jsx)(w.a,{alt:"\u0410\u0432\u0430",className:r.avatar,src:d.profilePicture})}),Object(k.jsx)(S.a,{primary:d.name,primaryTypographyProps:{noWrap:!0,variant:"h6"},secondary:"ID \u0434\u0438\u0430\u043b\u043e\u0433\u0430: ".concat(a.conversationId),secondaryTypographyProps:{noWrap:!0,variant:"body1"}}),Object(k.jsx)("div",{className:r.details,children:Object(k.jsx)(T.a,{noWrap:!0,variant:"body2"})})]}))},R=["conversations","className"],_=Object(i.a)((function(e){return{root:{backgroundColor:e.palette.white},searchInput:{flexGrow:1}}})),D=function(e){var t=e.conversations,a=e.className,n=Object(j.a)(e,R),c=_(),i=Object(r.a)().match.params.id;return Object(k.jsxs)("div",Object(l.a)(Object(l.a)({},n),{},{className:Object(s.default)(c.root,a),children:[Object(k.jsxs)(d.a,{children:[Object(k.jsx)(b.a,{className:c.searchInput,disableUnderline:!0,placeholder:"\u041d\u0430\u0439\u0442\u0438 \u0434\u0438\u0430\u043b\u043e\u0433"}),Object(k.jsx)(u.a,{title:"\u041f\u043e\u0438\u0441\u043a",children:Object(k.jsx)(O.a,{edge:"end",children:Object(k.jsx)(p.a,{})})})]}),Object(k.jsx)(h.a,{}),Object(k.jsx)(m.a,{disablePadding:!0,children:t.map((function(e,a){return Object(k.jsx)(G,{active:e.id===i,conversation:e,divider:a<t.length-1},e.id)}))})]}))},L=a(34),P=a(93),A=a(554),B=a(555),W=a(443),M=a(1487),$=a.n(M),V=a(1488),H=a.n(V),J=a(813),X=a.n(J),q=a(1489),z=a.n(q),F=a(715),K=a.n(F),Q=(a(391),["conversation","className"]),Y=Object(i.a)((function(e){return{root:{backgroundColor:e.palette.white},backButton:{marginRight:e.spacing(2),"@media (min-width: 864px)":{display:"none"}},user:{flexShrink:0,flexGrow:1},activity:{display:"flex",alignItems:"center"},statusBullet:{marginRight:e.spacing(1)},search:Object(n.a)({height:42,padding:e.spacing(0,2),display:"flex",alignItems:"center",flexBasis:300,marginLeft:"auto"},e.breakpoints.down("sm"),{flex:"1 1 auto"}),searchIcon:{marginRight:e.spacing(2),color:e.palette.icon},searchInput:{flexGrow:1}}})),Z=function(e){var t=e.conversation,a=e.className,n=Object(j.a)(e,Q),i=Y(),r=Object(c.useRef)(null),o=Object(c.useState)(!1),h=Object(L.a)(o,2),m=h[0],f=h[1],v=Object(C.c)((function(e){return e.auth._id})),g={};return g=t.firstUser.uid===v?Object(l.a)({},t.secondUser):Object(l.a)({},t.firstUser),Object(k.jsxs)(d.a,Object(l.a)(Object(l.a)({},n),{},{className:Object(s.default)(i.root,a),children:[Object(k.jsx)(u.a,{title:"\u041d\u0430\u0437\u0430\u0434",children:Object(k.jsx)(O.a,{className:i.backButton,component:x.b,edge:"start",to:"/chat",children:Object(k.jsx)($.a,{})})}),Object(k.jsxs)("div",{className:i.user,children:[Object(k.jsx)(T.a,{variant:"h6",children:g.name}),Object(k.jsxs)(T.a,{variant:"body2",children:["ID \u0434\u0438\u0430\u043b\u043e\u0433\u0430: ",t.conversationId]})]}),Object(k.jsxs)(P.a,{className:i.search,elevation:1,children:[Object(k.jsx)(p.a,{className:i.searchIcon}),Object(k.jsx)(b.a,{className:i.searchInput,disableUnderline:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0434\u0438\u0430\u043b\u043e\u0433\u0443"})]}),Object(k.jsx)(u.a,{title:"\u0411\u043e\u043b\u044c\u0448\u0435",children:Object(k.jsx)(O.a,{onClick:function(){f(!0)},ref:r,children:Object(k.jsx)(K.a,{})})}),Object(k.jsxs)(A.a,{anchorEl:r.current,keepMounted:!0,onClose:function(){f(!1)},open:m,children:[Object(k.jsxs)(B.a,{children:[Object(k.jsx)(W.a,{children:Object(k.jsx)(H.a,{})}),Object(k.jsx)(S.a,{primary:"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})]}),Object(k.jsxs)(B.a,{children:[Object(k.jsx)(W.a,{children:Object(k.jsx)(X.a,{})}),Object(k.jsx)(S.a,{primary:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"})]}),Object(k.jsxs)(B.a,{children:[Object(k.jsx)(W.a,{children:Object(k.jsx)(z.a,{})}),Object(k.jsx)(S.a,{primary:"\u041e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})]})]})]}))},ee=a(143),te=a.n(ee),ae=a(423),ne=["message","className"],ce=Object(i.a)((function(e){return{root:{marginBottom:e.spacing(2)},authUser:{display:"flex",justifyContent:"flex-end","& $body":{background:N.a.blueGrey[100]}},inner:{display:"flex",maxWidth:500},avatar:{marginRight:e.spacing(2)},body:{backgroundColor:N.a.grey[200],color:e.palette.text.primary,borderRadius:e.shape.borderRadius,padding:e.spacing(1,1.5)},content:{marginTop:e.spacing(.3)},image:{marginTop:e.spacing(2),height:"auto",width:380,maxWidth:"100%"},footer:{marginTop:e.spacing(1),display:"flex",justifyContent:"flex-end"}}})),se=function(e){var t=e.message,a=e.className,c=Object(j.a)(e,ne),i=ce(),r=Object(C.c)((function(e){return e.auth._id})),o=function(e,t){return e===t};return Object(k.jsx)("div",Object(l.a)(Object(l.a)({},c),{},{className:Object(s.default)(i.root,Object(n.a)({},i.authUser,o(t.sender.uid,r)),a),children:Object(k.jsxs)("div",{className:i.inner,children:[Object(k.jsx)(w.a,{className:i.avatar,component:x.b,src:t.sender.profilePicture,to:"/profile/".concat(t.sender.uid,"/wall")}),Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{className:i.body,children:[Object(k.jsx)(T.a,{variant:"body2",color:"secondary",children:Object(k.jsx)(ae.a,{color:"inherit",component:x.b,to:"/profile/".concat(t.sender.uid,"/wall"),variant:"h6",children:(o(t.sender.uid,r),t.sender.name)})}),Object(k.jsx)("div",{className:i.content,children:"image"===t.contentType?Object(k.jsx)("img",{alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430",className:i.image,src:t.content}):Object(k.jsx)(T.a,{color:"inherit",variant:"subtitle1",children:t.content})})]}),Object(k.jsx)("div",{className:i.footer,children:Object(k.jsx)(T.a,{className:i.time,variant:"body2",children:g()(t.date).fromNow()})})]})]})}))},ie=["messages","className"],re=Object(i.a)((function(e){return{root:{flexGrow:1,overflow:"hidden",maxHeight:"100%"},inner:{padding:e.spacing(2)}}})),oe=function(e){var t=e.messages,a=e.className,n=Object(j.a)(e,ie),c=re();return Object(k.jsx)("div",Object(l.a)(Object(l.a)({},n),{},{className:Object(s.default)(c.root,a),children:Object(k.jsx)(te.a,{children:Object(k.jsx)("div",{className:c.inner,children:t.map((function(e){return Object(k.jsx)(se,{message:e},e.id)}))})})}))},le=a(206),je=a.n(le),de=a(661),be=a(30),ue=a.n(be),Oe=a(17),he=a(10),me=["className","authUser","cId"],fe=Object(i.a)((function(e){return{root:{backgroundColor:e.palette.white,display:"flex",alignItems:"center",padding:e.spacing(1,2)},paper:{flexGrow:1,marginLeft:e.spacing(2),padding:e.spacing(.5,2)},input:{width:"100%"},divider:{width:1,height:24},fileInput:{display:"none"},form:{width:"100%"}}})),pe=function(e){var t=e.className,a=e.authUser,n=e.cId,i=Object(j.a)(e,me),r=fe();n||(n=Object(de.a)());var o=Object(c.useState)({conversationId:n,content:""}),d=Object(L.a)(o,2),m=d[0],f=d[1],p=Object(C.b)();return Object(k.jsx)("form",{className:r.form,noValidate:!0,onSubmit:function(e){e.persist();var t=Object(l.a)(Object(l.a)({},m),{},{date:new Date});p(function(e){return function(t,a){var n=a().auth._id,c=a().auth.name,s=a().auth.profilePicture;ue.a.post("".concat(Oe.c,"/messages"),Object(l.a)(Object(l.a)({},e),{},{sender:{uid:n,name:c,profilePicture:s}}),Object(Oe.a)()).then((function(e){t({type:"ADD_MESSAGE",conversation:e})})).catch((function(e){var t;console.log(e.response),he.b.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:he.b.POSITION.BOTTOM_RIGHT})}))}}(t)),f({content:""})},children:Object(k.jsxs)("div",Object(l.a)(Object(l.a)({},i),{},{className:Object(s.default)(r.root,t),children:[Object(k.jsx)(w.a,{alt:"Person",src:a.profilePicture}),Object(k.jsx)(P.a,{className:r.paper,elevation:1,children:Object(k.jsx)(b.a,{className:r.input,disableUnderline:!0,placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0447\u0442\u043e-\u043d\u0438\u0431\u0443\u0434\u044c...",value:m.content,onChange:function(e){return f(Object(l.a)(Object(l.a)({},m),{},{content:e.target.value}))}})}),Object(k.jsx)(u.a,{title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",type:"submit",children:Object(k.jsx)(O.a,{color:"primary",children:Object(k.jsx)(je.a,{})})}),Object(k.jsx)(h.a,{className:r.divider})]}))})},xe=["conversation","authUser","messages","className"],ve=Object(i.a)((function(e){return{root:{display:"flex",flexDirection:"column",backgroundColor:e.palette.white}}})),ge=function(e){var t=e.conversation,a=e.authUser,n=e.messages,c=e.className,i=Object(j.a)(e,xe),r=ve();return Object(k.jsxs)("div",Object(l.a)(Object(l.a)({},i),{},{className:Object(s.default)(r.root,c),children:[Object(k.jsx)(Z,{conversation:t}),Object(k.jsx)(h.a,{}),Object(k.jsx)(oe,{messages:n}),Object(k.jsx)(h.a,{}),Object(k.jsx)(pe,{cId:t.conversationId,authUser:a})]}))},Ne=["className"],ye=Object(i.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"center"},inner:{textAlign:"center"},image:{maxWidth:400},title:{margin:e.spacing(4,0,1,0)}}})),Ie=function(e){var t=e.className,a=Object(j.a)(e,Ne),n=ye();return Object(k.jsx)("div",Object(l.a)(Object(l.a)({},a),{},{className:Object(s.default)(n.root,t),children:Object(k.jsx)("div",{className:n.inner,children:Object(k.jsx)(T.a,{variant:"subtitle1",children:"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433 \u0441\u043b\u0435\u0432\u0430, \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u043a\u0443"})})}))},we=a(948),Se=Object(i.a)((function(e){return{root:{height:"100%",display:"flex","@media (max-width: 863px)":{"& $conversationList, & $conversationDetails":{flexBasis:"100%",width:"100%",maxWidth:"none",flexShrink:"0",transform:"translateX(0)"}}},openConversion:{"@media (max-width: 863px)":{"& $conversationList, & $conversationDetails":{transform:"translateX(-100%)"}}},conversationList:{width:300,flexBasis:300,flexShrink:0,"@media (min-width: 864px)":{borderRight:"1px solid ".concat(e.palette.divider)}},conversationDetails:{flexGrow:1},conversationPlaceholder:{flexGrow:1}}})),Te=function(e){var t,a=e.history,i=Se(),l=Object(r.a)(),j=Object(C.b)(),d=Object(C.c)((function(e){return e.auth}));Object(c.useEffect)((function(){j(Object(we.b)(d._id))}),[j]);var b=Object(C.c)((function(e){return e.conversationsList}));Object(c.useEffect)((function(){var e;j((e=l.match.params.id,function(t){ue.a.get("".concat(Oe.c,"/messages/").concat(e),Object(Oe.a)()).then((function(e){t({type:"CLEAR_MESSAGES"}),t({type:"GET_MESSAGES",messagesList:e})})).catch((function(e){console.log(e)}))}))}),[j,l.match.params.id]);var u,O,h=Object(C.c)((function(e){return e.messagesList})),m=Object(C.c)((function(e){return e}));return console.log(m),Object(C.c)((function(e){return e.auth}))._id||a.push("/"),l.match.params.id&&(u=b.find((function(e){return e.conversationId===l.match.params.id})),O=h.filter((function(e){return e.conversationId===l.match.params.id}))),Object(k.jsxs)(o.a,{className:Object(s.default)((t={},Object(n.a)(t,i.root,!0),Object(n.a)(t,i.openConversion,u),t)),title:"\u0427\u0430\u0442\u044b",children:[Object(k.jsx)(D,{className:i.conversationList,conversations:b}),u&&O?Object(k.jsx)(ge,{className:i.conversationDetails,conversation:u,messages:O,authUser:d}):Object(k.jsx)(Ie,{className:i.conversationPlaceholder})]})}},948:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(6),c=a(30),s=a.n(c),i=a(17),r=a(10),o=function(e){return function(t){s.a.get("".concat(i.c,"/conversations/").concat(e),Object(i.a)()).then((function(e){t({type:"CLEAR_CONVERSATIONS"}),t({type:"GET_CONVERSATIONS",conversationsList:e})})).catch((function(e){console.log(e)}))}},l=function(e){return function(t){s.a.post("".concat(i.c,"/conversations"),Object(n.a)({},e),Object(i.a)()).then((function(e){t({type:"ADD_CONVERSATION",conversation:e})})).catch((function(e){var t;console.log(e.response),r.b.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:r.b.POSITION.BOTTOM_RIGHT})}))}}}}]);
//# sourceMappingURL=10.f19e2230.chunk.js.map